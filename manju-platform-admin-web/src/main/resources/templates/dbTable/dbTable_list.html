<div class="page-bar" xmlns:th="http://www.w3.org/1999/xhtml">
    <div class="page-title-breadcrumb">
        <ol class="breadcrumb page-breadcrumb pull-left">
            <li><i class="fa fa-home"></i>&nbsp;<a class="parent-item" href="index">Home</a>&nbsp;<i
                    class="fa fa-angle-right"></i>
            </li>
            <li class="active">代码生成器</li>
        </ol>
    </div>
</div>

<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="card">
            <div class="card-head">
                <header>代码生成器</header>
            </div>
            <div class="card-body ">
                <table id="dataTable" class="display" style="width: 100%"></table>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        $('#dataTable').DataTable({
            "scrollX": true,
            columns: [
                {title: "表名", data: "tableName", class: "text-center"},
                {title: "标识", data: "tableComment", class: "text-center"},
                {
                    title: "操作", data: "tableName", class: "text-center", render:function (data, type, row) {
                        return '<button type="button" class="btn btn-circle btn-info btn-sm" onclick="doGenerator(\''+ data +'\')">代码生成</button>';
                    }
                }
            ],
            "ajax": {//类似jquery的ajax参数，基本都可以用。
                type: "post",//后台指定了方式，默认get，外加datatable默认构造的参数很长，有可能超过get的最大长度。
                url: "/dbTable/listData",
                dataSrc: "data",//默认data，也可以写其他的，格式化table的时候取里面的数据
                data: function (d) {//d 是原始的发送给服务器的数据，默认很长。
                    var param = {};//因为服务端排序，可以新建一个参数对象
                    param.start = d.start;//开始的序号
                    param.length = d.length;//要取的数据的
                    /*var formData = $("#search_form").serializeArray();//把form里面的数据序列化成数组
                    formData.forEach(function (e) {
                        param[e.name] = e.value;
                    });*/
                    return param;//自定义需要传递的参数。
                }
            },
            serverSide: true,//分页，取数据等等的都放到服务端去
            processing: true,//载入数据的时候是否显示“载入中”
            pageLength: 10,//首次加载的数据条数
            ordering: false,//排序操作在服务端进行，所以可以关了。
            language: {
                lengthMenu: "每页显示 _MENU_ 条",//左上角的分页大小显示
                search: "搜索: _INPUT_",
                processing: "正在载入数据...",//处理页面数据的时候的显示
                paginate: {//分页的样式文本内容。
                    previous: "上一页",
                    next: "下一页",
                    first: "第一页",
                    last: "最后一页"
                },
                zeroRecords: "暂时没有任何数据记录",//table tbody内容为空时，tbody的内容。
                //下面三者构成了总体的左下角的内容。
                info: "第 _PAGE_/_PAGES_页 共 _TOTAL_条记录",//左下角的信息显示，大写的词为关键字。
                infoEmpty: "第 _PAGE_/_PAGES_页 共 _TOTAL_条记录",//筛选为空时左下角的显示。
                infoFiltered: ""//筛选之后的左下角筛选提示(另一个是分页信息显示，在上面的info中已经设置，所以可以不显示)，
            }
        });
    });

    function doGenerator(tableName){
        alert(tableName);
        $.post(
            '/dbTable/doGenerator',
            {tableName:tableName},
            function (data, textStatus, jqXHR) {
                if(data.result){
                    alert("代码已生成");
                }else{
                    alert(data.msg);
                }
            },
            'json'
        )
    }
</script>